<!doctype html>
<html lang="en">
<head>
    <title>Platform Manager</title>
    <!-- Bootstrap core CSS -->
    <link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
          integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
</head>
<body>
<div class="container-fluid">
    <img id="logo" src="http://www.teamorlando.org/wp-content/uploads/2012/11/ARL-2016.jpg">
    <div class="row">
        <div aria-label="First group" class="btn-group mr-2" role="group">

            <button class="btn btn-dark btn-sm menu" type="button"><a href="indexAdmin.html">Managers Menu</a></button>

            <button class="btn btn-dark btn-sm menu" type="button"><a href="connectionMan.html">Connection Manager</a>
            </button>

            <button class="btn btn-dark btn-sm menu" type="button"><a href="accountsMan.html">Account Manager</a>
            </button>

            <button class="btn btn-dark btn-sm menu active" type="button"><a href="platMan.html" id="pressed">Platform
                Manager</a></button>

        </div>
    </div>
</div>
<div class="container-fluid">
    <table class="table table-hover" id="platformsTable">
        <thead>
        <tr>
            <th><a href="javascript:SortTable(0,'T', 'platformsTable');">Name</a></th>
            <th><a href="javascript:SortTable(1,'T', 'platformsTable');">IP : Port</a></th>
            <th><a href="javascript:SortTable(2,'T', 'platformsTable');">ID</a></th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    <script src="tablesorter.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script>
        (function worker() {
            // noinspection JSUnusedGlobalSymbols
            $.ajax({
                type: "GET",
                url: "http://localhost:5001/api/v2/resources/platform",
                contentType: "application/json",
                dataType: "json",
                data: {
                    'all': 'True'
                },
                success: function (response) {
                    //Print results
                    console.log("Accessed Database at " + new Date().toUTCString());
                    let array = response;
                    let trHTML = '<tbody>';
                    for (let i in array) {
                        // console.log(JSON.stringify(array[i]));
                        let id = array[i]["main"]["id"];
                        let name = array[i]["main"]["name"];
                        let ip_port = array[i]["main"]["ip_port"];
                        trHTML += '<tr><td>' + name + '</td><td>' + ip_port + '</td><td>' + id + '</td></tr>';
                    }
                    trHTML += '</tbody>';
                    $('#platformsTable tbody').replaceWith(trHTML);
                    SortTable(0, 'T', 'platformsTable', true)
                }
            });

        })();
    </script>
</div>
</body>
</html>
